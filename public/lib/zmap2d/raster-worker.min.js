"use strict";!function(t){let e;!function(t){t.ISO_LINES="isolines",t.ISO_BANDS="isobands"}(e=t.IsoTracerType||(t.IsoTracerType={}));class i{static buildGrid(t,e){const i=e[2]-e[0],s=e[3]-e[1],r=i/t.width,n=s/t.height,a={type:"FeatureCollection",features:new Array(t.width*t.height)};for(let i=0;i<t.height;++i)for(let s=0;s<t.width;++s){const o=s+i*t.width;a.features[o]={type:"Feature",properties:{v:t.data[o]},geometry:{type:"Point",coordinates:[e[0]+(s+.5)*r,e[1]+(i+.5)*n]}}}return a}static trace(t,e,i,s){return-1!=t.indexOf("lines")?this.tracelines(e,i,s):-1!=t.indexOf("bands")?this.tracebands(e,i,s):void 0}static traceByResample(t,e,s,r,n,a){const o=s.subData2(r,n,a);return i.trace(t,o,o.extent,e)}static tracelines(e,s,r){return t.DebugTicks.logCost("trace isolines",()=>{const t=i.buildGrid(e,s);return turf.isolines(t,r,{zProperty:"v"})})}static tracebands(e,s,r){return t.DebugTicks.logCost("trace isolines",()=>{const t=i.buildGrid(e,s);return turf.isobands(t,r,{zProperty:"v"})})}static simplify(e,i,s){const r=[];e.features.forEach(t=>{t.geometry.coordinates.length>0&&r.push(t)}),e.features=r;const n=Math.min(t.Extents.width(i),t.Extents.height(i))/1e3;return turf.simplify(e,{tolerance:n,highQuality:s})}}t.IsoTracer=i}(OLE||(OLE={})),function(t){class e{constructor(t){t=t||{},this._width=t.width||0,this._height=t.height||0,this._bands=t.bands||1;const e=this._width*this._height*this._bands;t.data&&t.data.length==e?t.data instanceof Float32Array||t.data instanceof Float64Array?this._data=t.data:this._data=new Float32Array(t.data):this._data=new Float32Array(e)}static create(t,i,s,r){return new e({width:t,height:i,bands:s,data:r})}get width(){return this._width}get height(){return this._height}get bands(){return this._bands}get data(){return this._data}isEmpty(){return 0===this._width&&0===this._height}subData(t){const i=this.subDataInner(t);return e.create(t.width,t.height,this.bands,i)}subDataInner(t){if(function(t,e,s){const r="invaild clip";i(s.x,0,t-1,r),i(s.y,0,e-1,r),i(s.width,1,t-s.x,r),i(s.height,1,e-s.y,r)}(this.width,this.height,t),t.width==this.width&&t.height==this.height)return this._data.slice();const e=new Float32Array(t.width*t.height*this.bands),s=this.bands;for(let i=0;i<s;++i)for(let r=0;r<t.height;++r){const n=r*t.width,a=(r+t.y)*this.width;for(let r=0;r<t.width;++r){const o=a+(r+t.x)*s+i;e[n+r*s+i]=this.data[o]}}return e}}function i(t,e,i,s){if(t<e||t>i){if(s)throw new Error(s);return!1}return!0}t.Bitmap=e}(OLE||(OLE={})),function(t){class e extends t.Bitmap{constructor(e){if(super(e),e)if(this._extent=e.extent.slice(),this._geoWidth=t.Extents.width(this._extent),this._geoHeight=t.Extents.height(this._extent),this._cellWidth=this._geoWidth/this.width,this._cellHeight=this._geoHeight/this.height,this._noDataValue=e.noDataValue,t.defined(e.vmin)&&t.defined(e.vmax))this._minValue=e.vmin,this._maxValue=e.vmax;else{let t=Number.POSITIVE_INFINITY,e=Number.NEGATIVE_INFINITY;const i=this.data,s=i.length;for(let r=0;r<s;++r){const s=i[r];s<t&&(t=s),s>e&&(e=s)}this._minValue=t,this._maxValue=e}else this._extent=t.Extents.createEmpty(),this._cellWidth=0,this._cellHeight=0,this._geoWidth=0,this._geoHeight=0}get extent(){return this._extent.slice()}get cellWidth(){return this._cellWidth}get cellHeight(){return this._cellHeight}get geoWidth(){return this._geoWidth}get geoHeight(){return this._geoHeight}get noDataValue(){return this._noDataValue}get minValue(){return this._minValue}get maxValue(){return this._maxValue}getValue(t,e){if(!this._data)return;const i=Math.floor((t-this._extent[0])/this._cellWidth),s=Math.floor((e-this._extent[1])/this._cellHeight);return i<0||i>=this._width||s<0||s>=this._height?void 0:this._data[i+s*this._width]}subData(t){const i=super.subDataInner(t),s=t.x*this._cellWidth+this._extent[0],r=t.y*this._cellHeight+this._extent[1],n=s+t.width*this._cellWidth,a=r+t.height*this._cellHeight;return new e({width:t.width,height:t.height,extent:[s,r,n,a],bands:this.bands,data:i,vmin:this._minValue,vmax:this._maxValue,noDataValue:this._noDataValue})}subData2(i,s,r){const n=t.Extents.width(i),a=t.Extents.height(i),o=n/s[0],h=a/s[1],c=t.Extents.intersection(this._extent,i);if(t.Extents.isEmpty(c))return null;let l=this,u=this._extent,f=this._geoWidth,d=this._geoHeight;const g=t.Extents.width(c),m=t.Extents.height(c);if(g<this._geoWidth/2||m<this._geoHeight/2){const e=3,i=t.Extents.bufferXY(c,this._cellWidth*e,this._cellHeight*e),s=this.toPixelCoord(i);t.Extents.intersection(s,[0,0,this.width,this.height],s),u=this.toGeoCoord(s),f=t.Extents.width(u),d=t.Extents.height(u),l=super.subData({x:s[0],y:s[1],width:t.Extents.width(s),height:t.Extents.height(s)})}const w=Math.ceil(f/o),_=Math.ceil(d/h),x=f/w,E=d/_,p=Math.round((c[0]-u[0])/x),b=Math.round((c[1]-u[1])/E),L=Math.round((c[2]-u[0])/x),y=Math.round((c[3]-u[1])/E),F=t.doRescale(l,w,_,r,this._noDataValue,{x:p,y:b,width:L-p,height:y-b});return new e({width:F.width,height:F.height,extent:c,bands:this.bands,data:F.data,vmin:this._minValue,vmax:this._maxValue,noDataValue:this._noDataValue})}toPixelCoord(t){return[Math.floor((t[0]-this._extent[0])/this._cellWidth),Math.floor((t[1]-this._extent[1])/this._cellHeight),Math.ceil((t[2]-this._extent[0])/this._cellWidth),Math.ceil((t[3]-this._extent[1])/this._cellHeight)]}toGeoCoord(t){return[t[0]*this._cellWidth+this._extent[0],t[1]*this._cellHeight+this._extent[1],t[2]*this._cellWidth+this._extent[0],t[3]*this._cellHeight+this._extent[1]]}toDataObject(){return{data:this._data,width:this._width,height:this._height,bands:this._bands,extent:this._extent,vmin:this._minValue,vmax:this._maxValue,noDataValue:this._noDataValue}}toPixelData(t){const{width:e,height:i,minValue:s,maxValue:r}=this,n=r-s,a=this.width*this.height,o=t.length/4|0,h=this._data,c=new Uint8ClampedArray(4*a);for(let r=0;r<i;++r)for(let a=0;a<e;++a){const l=4*(a+(i-r-1)*e),u=h[a+r*e];if(u==this.noDataValue)c[l]=0,c[l+1]=0,c[l+2]=0,c[l+3]=0;else{let e=(u-s)/n*o|0;e<0?e=0:e>=o&&(e=o-1);const i=4*e;c[l]=t[i+0],c[l+1]=t[i+1],c[l+2]=t[i+2],c[l+3]=t[i+3]}}return c}}t.RasterDataset=e}(OLE||(OLE={})),function(t){function e(t,e,i,s){if(t<e||t>i){if(s)throw new Error(s);return!1}return!0}function i(t,i,s){const r="invaild clip";e(s.x,0,t-1,r),e(s.y,0,i-1,r),e(s.width,1,t-s.x,r),e(s.height,1,i-s.y,r)}class s{constructor(t){this.m_pFilter=t}scale(e,s,r,n){s=Math.floor(s),r=Math.floor(r);const a=e.width,o=e.height;if(n?i(s,r,n):n={x:0,y:0,width:s,height:r},a==s&&o==r)return e.subData(n);const h=t.Bitmap.create(n.width,n.height,e.bands),c=n.x,l=n.x+n.width,u=n.y,f=n.y+n.height;if(s<=a){let i=null;a!==s?(i=o!==r?t.Bitmap.create(n.width,o,e.bands):h,this.horizontalFilter(e,i,s,c,l)):i=e,o!==r&&this.verticalFilter(i,h,r,u,f)}else{let i=null;o!=r?(i=a!=s?t.Bitmap.create(a,n.height,e.bands):h,this.verticalFilter(e,i,r,u,f)):i=e,a!=s&&this.horizontalFilter(i,h,s,c,l)}return h}horizontalFilter(e,i,s,r,n){const a=new t.CWeightsTable(this.m_pFilter,s,e.width,r,n).m_WeightTable,o=e.data,h=i.data,c=e.bands;for(let t=0;t<c;++t)for(let s=0;s<e.height;s++){const r=e.width*s;let n=i.width*s;for(let e=0;e<i.width;e++){const i=a[e],s=i.Weights,l=i.Left,u=i.Right;let f=0;for(let e=l;e<u;++e){f+=s[e-l]*o[r+(e*c+t)]}h[n+t]=f,n+=c}}}verticalFilter(e,i,s,r,n){const a=new t.CWeightsTable(this.m_pFilter,s,e.height,r,n).m_WeightTable,o=e.data,h=i.data,c=e.bands,l=i.width*i.bands,u=e.width*e.bands;for(let t=0;t<c;++t)for(let s=0;s<e.width;++s){const e=s*c;let r=e;for(let s=0;s<i.height;++s){const i=a[s],n=i.Weights,c=i.Left,f=i.Right;let d=c*u+e,g=0;for(let e=c;e<f;++e){g+=n[e-c]*o[d+t],d+=u}h[r+t]=g,r+=l}}}}let r;function n(e){let i=null;switch(e){case r.FILTER_BOX:i=new t.CBoxFilter;break;case r.FILTER_BICUBIC:i=new t.CBicubicFilter;break;case r.FILTER_BILINEAR:i=new t.CBilinearFilter;break;case r.FILTER_BSPLINE:i=new t.CBSplineFilter;break;case r.FILTER_CATMULLROM:i=new t.CCatmullRomFilter;break;case r.FILTER_LANCZOS3:i=new t.CLanczos3Filter}return i}!function(t){t[t.FILTER_BOX=0]="FILTER_BOX",t[t.FILTER_BICUBIC=1]="FILTER_BICUBIC",t[t.FILTER_BILINEAR=2]="FILTER_BILINEAR",t[t.FILTER_BSPLINE=3]="FILTER_BSPLINE",t[t.FILTER_CATMULLROM=4]="FILTER_CATMULLROM",t[t.FILTER_LANCZOS3=5]="FILTER_LANCZOS3"}(r=t.FILTER||(t.FILTER={})),t.createFilter=n,t.doRescale=function(e,i,r,a,o,h){let c=n(a);if(!c)return null;e instanceof t.Bitmap||(e=new t.Bitmap(e));const l=h?h.width:i,u=h?h.height:r;console.info(`scale start, ${e.width}*${e.height} => ${l}*${u}`);const f=new Date,d=new s(c),g=d.scale(e,i,r,h);if(null!=o){const s=e.data.slice();s.forEach((t,e)=>{s[e]=t===o?0:1});const n=t.Bitmap.create(e.width,e.height,e.bands,s),a=d.scale(n,i,r,h).data,c=g.data;a.forEach((t,e)=>{t<.95&&(c[e]=o)})}const m=new Date;return console.info("scale finish, cost: "+(m.getTime()-f.getTime())),g}}(OLE||(OLE={})),function(t){t.CWeightsTable=class{constructor(t,e,i,s,r){let n,a;const o=t.GetWidth();void 0===s&&(s=0),void 0===r&&(r=e);const h=r-s,c=e/i;c<1?(n=o/c,a=c):(n=o,a=1);const l=2*Math.ceil(n)+1,u=h,f=new Float64Array(u*l);this.m_WeightTable=[];const d=l*Float64Array.BYTES_PER_ELEMENT;for(let t=0;t<u;t++){const e=t*d,i=new Float64Array(f.buffer,e,l);this.m_WeightTable[t]={Weights:i,Left:0,Right:0}}const g=.5/c;for(let e=0;e<u;e++){const r=this.m_WeightTable[e],o=r.Weights,h=(e+s)/c+g,l=Math.max(0,Math.floor(h-n+.5)),u=Math.min(Math.floor(h+n+.5),i);r.Left=l,r.Right=u;let f=0;for(let e=l;e<u;e++){const i=a*t.Filter(a*(e+.5-h));o[e-l]=i,f+=i}if(f>0&&1!=f)for(let t=l;t<u;t++)o[t-l]/=f;let d=u-l-1;for(;0==o[d]&&(r.Right--,d--,r.Right!=r.Left););}}get(t){return this.m_WeightTable[t]}getWeight(t,e){return this.m_WeightTable[t].Weights[e]}getLeftBoundary(t){return this.m_WeightTable[t].Left}getRightBoundary(t){return this.m_WeightTable[t].Right}}}(OLE||(OLE={})),function(t){class e{constructor(t){this.m_dWidth=t}GetWidth(){return this.m_dWidth}SetWidth(t){this.m_dWidth=t}}t.CGenericFilter=e;t.CBoxFilter=class extends e{constructor(){super(.5)}Filter(t){return Math.abs(t)<=this.m_dWidth?1:0}};t.CBilinearFilter=class extends e{constructor(){super(1)}Filter(t){return(t=Math.abs(t))<this.m_dWidth?this.m_dWidth-t:0}};t.CBicubicFilter=class extends e{constructor(t=1/3,e=1/3){super(2),this.p0=(6-2*t)/6,this.p2=(12*t-18+6*e)/6,this.p3=(12-9*t-6*e)/6,this.q0=(8*t+24*e)/6,this.q1=(-12*t-48*e)/6,this.q2=(6*t+30*e)/6,this.q3=(-t-6*e)/6}Filter(t){return(t=Math.abs(t))<1?this.p0+t*t*(this.p2+t*this.p3):t<2?this.q0+t*(this.q1+t*(this.q2+t*this.q3)):0}};t.CCatmullRomFilter=class extends e{constructor(){super(2)}Filter(t){return t<-2?0:t<-1?.5*(4+t*(8+t*(5+t))):t<0?.5*(2+t*t*(-5-3*t)):t<1?.5*(2+t*t*(3*t-5)):t<2?.5*(4+t*(t*(5-t)-8)):0}};t.CLanczos3Filter=class extends e{constructor(){super(3)}Filter(t){return(t=Math.abs(t))<this.m_dWidth?this.sinc(t)*this.sinc(t/this.m_dWidth):0}sinc(t){return 0!=t?(t*=3.141592653589793,Math.sin(t)/t):1}};t.CBSplineFilter=class extends e{constructor(){super(2)}Filter(t){if((t=Math.abs(t))<1)return(4+t*t*(3*t-6))/6;if(t<2){let e=2-t;return e*e*e/6}return 0}};t.CBlackmanFilter=class extends e{constructor(t=.5){super(t)}Filter(t){if(Math.abs(t)>this.m_dWidth)return 0;return t/=2*this.m_dWidth+1-1,.42+.5*Math.cos(6.283185307179586*t)+.08*Math.cos(12.566370614359172*t)}}}(OLE||(OLE={})),function(t){class e{constructor(t,e,i,s){this._degree=t;const r=e.length,n=r+t+1;if(t<1)throw new Error("degree must be at least 1 (linear)");if(t>r-1)throw new Error("degree must be less than or equal to point count - 1");const a=e[0].length;if(s){if(s.length!=r)throw new Error("bad weights vector length")}else{s=[];for(let t=0;t<r;t++)s[t]=1}if(i){if(i.length!==n)throw new Error("bad knot vector length")}else{i=[];for(let t=0;t<n;t++)i[t]=t}this._konts=i,this._dim=a,this._vdata=[];const o=this._vdata,h=a+1;for(let t=0;t<r;t++){for(let i=0;i<a;i++)o[t*h+i]=e[t][i]*s[t];o[t*h+a]=s[t]}}interp(t,e){const i=this._degree,s=this._konts,r=this._dim,n=r+1,a=[i,s.length-1-i],o=s[a[0]],h=s[a[1]];if((t=t*(h-o)+o)<o||t>h)throw new Error("out of bounds");let c=0;for(c=a[0];c<a[1]&&!(t>=s[c]&&t<=s[c+1]);c++);const l=this._vdata.slice();for(let e=1;e<=i+1;e++)for(let a=c;a>c-i-1+e;a--){const o=(t-s[a])/(s[a+i+1-e]-s[a]);for(let t=0;t<r+1;t++){const e=l[a*n+t],i=l[(a-1)*n+t];l[a*n+t]=(1-o)*i+o*e}}e=e||[];for(let t=0;t<r;t++)e[t]=l[c*n+t]/l[c*n+r];return e}static interp(t,i,s){s=s||2;const r=[],n=t.length+s+1;for(let t=0;t<n;++t)r[t]=t<s+1?0:t>=n-s-1?n-1:t;const a=[],o=new e(s,t,r);for(let t=0;t<=i;++t)a.push(o.interp(t/i));return a}}t.BSPLine=e}(OLE||(OLE={})),function(t){t.Base64=class{static byteLength(t){var e=a(t),i=e[0],s=e[1];return 3*(i+s)/4-s}static toByteArray(t){let e;const s=a(t),r=s[0],n=s[1],o=new Uint8Array(function(t,e,i){return 3*(e+i)/4-i}(0,r,n));let h=0;const c=n>0?r-4:r;let l;for(l=0;l<c;l+=4)e=i[t.charCodeAt(l)]<<18|i[t.charCodeAt(l+1)]<<12|i[t.charCodeAt(l+2)]<<6|i[t.charCodeAt(l+3)],o[h++]=e>>16&255,o[h++]=e>>8&255,o[h++]=255&e;return 2===n&&(e=i[t.charCodeAt(l)]<<2|i[t.charCodeAt(l+1)]>>4,o[h++]=255&e),1===n&&(e=i[t.charCodeAt(l)]<<10|i[t.charCodeAt(l+1)]<<4|i[t.charCodeAt(l+2)]>>2,o[h++]=e>>8&255,o[h++]=255&e),o}static fromByteArray(t){let i;const s=t.length,r=s%3,n=[],a=16383;for(var o=0,c=s-r;o<c;o+=a)n.push(h(t,o,o+a>c?c:o+a));return 1===r?(i=t[s-1],n.push(e[i>>2]+e[i<<4&63]+"==")):2===r&&(i=(t[s-2]<<8)+t[s-1],n.push(e[i>>10]+e[i>>4&63]+e[i<<2&63]+"=")),n.join("")}};const e=[],i=[],s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var r=0,n=s.length;r<n;++r)e[r]=s[r],i[s.charCodeAt(r)]=r;function a(t){const e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");let i=t.indexOf("=");-1===i&&(i=e);return[i,i===e?0:4-i%4]}function o(t){return e[t>>18&63]+e[t>>12&63]+e[t>>6&63]+e[63&t]}function h(t,e,i){let s;for(var r=[],n=e;n<i;n+=3)s=(t[n]<<16&16711680)+(t[n+1]<<8&65280)+(255&t[n+2]),r.push(o(s));return r.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63}(OLE||(OLE={})),function(t){class e{static parseCssColorString(t){function i(t,e){return null==t?e:t}if(!t)return;const s=e.Colors[t.toUpperCase()];if(s)return s.slice();const r=[0,0,0,0];let n=e.rgbaMatcher.exec(t);return null!==n?(r[0]=Math.floor(parseInt(n[1],16)/15*255),r[1]=Math.floor(parseInt(n[2],16)/15*255),r[2]=Math.floor(parseInt(n[3],16)/15*255),r[3]=Math.floor(parseInt(i(n[4],"f"),16)/15*255),r):(n=e.rrggbbaaMatcher.exec(t),null!==n?(r[0]=parseInt(n[1],16),r[1]=parseInt(n[2],16),r[2]=parseInt(n[3],16),r[3]=parseInt(i(n[4],"ff"),16),r):(n=e.rgbParenthesesMatcher.exec(t),null!==n?(r[0]=Math.floor(parseFloat(n[1])*("%"===n[1].substr(-1)?2.55:1)),r[1]=Math.floor(parseFloat(n[2])*("%"===n[2].substr(-1)?2.55:1)),r[2]=Math.floor(parseFloat(n[3])*("%"===n[3].substr(-1)?2.55:1)),r[3]=Math.floor(255*parseFloat(i(n[4],"1.0"))),r):void 0))}}e.rgbaMatcher=/^#([0-9a-f])([0-9a-f])([0-9a-f])([0-9a-f])?$/i,e.rrggbbaaMatcher=/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})?$/i,e.rgbParenthesesMatcher=/^rgba?\(\s*([0-9.]+%?)\s*,\s*([0-9.]+%?)\s*,\s*([0-9.]+%?)(?:\s*,\s*([0-9.]+))?\s*\)$/i,e.hslParenthesesMatcher=/^hsla?\(\s*([0-9.]+)\s*,\s*([0-9.]+%)\s*,\s*([0-9.]+%)(?:\s*,\s*([0-9.]+))?\s*\)$/i,e.Colors={RED:[255,0,0,255],GREEN:[0,255,0,255],BLUE:[0,0,255,255],WHITE:[255,255,255,0],BLACK:[0,0,0,255]},t.ColorTool=e}(OLE||(OLE={})),function(t){t.DataRowsHelp=class{constructor(t,e,i){this._fields={},t&&t.forEach((t,e)=>this._fields[t]=e),this._values=e,this._fieldMap=i}get values(){return this._values}forEach(t){this._values.forEach(t)}readValue(t,e){if(this._fieldMap){const t=this._fieldMap[e];t&&(e=t)}return Array.isArray(t)?t[this._fields[e]]:t[e]}readByIndex(t,e){const i=this._values[t];if(i)return this.readValue(i,e)}}}(OLE||(OLE={})),function(t){t.DebugTicks=class{constructor(t){this._name=t}start(){this._start=new Date,console.info(this._name+" started")}finish(){this._end=new Date;const t=this._end.getTime()-this._start.getTime();console.info(`${this._name} finished, cost:${t}`)}static logCost(t,e){const i=new Date;console.info("start "+t);const s=e(),r=((new Date).getTime()-i.getTime())/1e3;return console.info(`finished ${t}, cost:${r.toFixed(2)}s`),s}}}(OLE||(OLE={})),function(t){class e{static width(t){return t[2]-t[0]}static height(t){return t[3]-t[1]}static isEmpty(t){return t[2]<t[0]||t[3]<t[1]}static isEquals(t,e){return t[0]==e[0]&&t[2]==e[2]&&t[1]==e[1]&&t[3]==e[3]}static clone(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t.slice()}static createEmpty(){return[1/0,1/0,-1/0,-1/0]}static isIntersects(t,e){return t[0]<=e[2]&&t[2]>=e[0]&&t[1]<=e[3]&&t[3]>=e[1]}static intersection(t,i,s){var r=s||e.createEmpty();return e.isIntersects(t,i)&&(r[0]=Math.max(t[0],i[0]),r[1]=Math.max(t[1],i[1]),r[2]=Math.min(t[2],i[2]),r[3]=Math.min(t[3],i[3])),r}static mergePointXY(t,e,i){if(this.isEmpty(t))return t[0]=t[2]=e,void(t[1]=t[3]=i);e<t[0]&&(t[0]=e),e>t[2]&&(t[2]=e),i<t[1]&&(t[1]=i),i>t[3]&&(t[3]=i)}static mergePoint(t,e){this.mergePointXY(t,e[0],e[1])}static mergePointArray(t,e){e.forEach(e=>this.mergePoint(t,e))}static center(t,e){const i=(t[2]+t[0])/2,s=(t[3]+t[1])/2;return e?(e[0]=i,e[1]=s,e):[i,s]}static buffer(t,e,i){return this.bufferXY(t,e,e,i)}static bufferXY(t,e,i,s){return s||(s=[]),s[0]=t[0]-e,s[1]=t[1]-i,s[2]=t[2]+e,s[3]=t[3]+i,s}}t.Extents=e}(OLE||(OLE={})),function(t){let e,i,s;function r(t){return t===s.POSITIVE?1:-1}!function(t){t.LEFT="left",t.RIGHT="right",t.CENTER="center"}(e=t.DockedLocateX||(t.DockedLocateX={})),function(t){t.TOP="top",t.BOTTOM="bottom",t.CENTER="center"}(i=t.DockedLocateY||(t.DockedLocateY={})),function(t){t.POSITIVE="positive",t.NEGATIVE="negative"}(s=t.DockedDir||(t.DockedDir={}));t.DockedBar=class{constructor(t){this.dockx=e.LEFT,this.docky=i.TOP,this.dockxdir=s.POSITIVE,this.dockydir=s.POSITIVE,this.offsetx=0,this.offsety=0,this.width=0,this.height=0,Object.assign(this,t)}getRange(s){const[n,a,o,h]=s,[c,l]=t.Extents.center(s),u=r(this.dockxdir),f=r(this.dockydir);let d=0,g=0;switch(this.dockx){case e.LEFT:d=n;break;case e.RIGHT:d=o;break;case e.CENTER:d=c}switch(this.docky){case i.TOP:g=a;break;case i.BOTTOM:g=h;break;case i.CENTER:g=l}let m=d+this.offsetx*u,w=g+this.offsety*f,_=m+this.width*u,x=w+this.height*f;if(m>_){const t=m;m=_,_=t}if(w>x){const t=w;w=x,x=t}return[m,w,_,x]}}}(OLE||(OLE={})),function(t){class e{static triangleArea(t,e,i){const s=(t[0]-i[0])*(e[1]-i[1])-(t[1]-i[1])*(e[0]-i[0]);return s<1e-20&&s>-1e-20?0:s/2}static intersect(t,i,s,r,n,a){const o=e.triangleArea(t,i,s),h=e.triangleArea(t,i,r);if(a&&o*h>=0)return!1;const c=e.triangleArea(s,r,t),l=e.triangleArea(s,r,i);if(a&&c*l>=0)return!1;if(h-o==0)return!1;if(n){const e=c/(h-o),s=e*(i[0]-t[0]),r=e*(i[1]-t[1]);n[0]=t[0]+s,n[1]=t[1]+r}return!0}}t.GeoMath=e}(OLE||(OLE={})),function(t){const e=32768;let i,s,r,n,a,o,h,c,l,u,f,d,g,m,w=null;const _=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535],x=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],E=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,99,99],p=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],b=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],L=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];function y(t,e){const i=new Array(t);for(let s=0;s<t;++s)i[s]=e;return i}class F{constructor(){this.next=null,this.list=null}}class M{constructor(){this.e=0,this.b=0,this.n=0,this.t=null}}class I{constructor(t,e,i,s,r,n){this.BMAX=16,this.N_MAX=288,this.status=0,this.root=null,this.m=0;const a=y(this.BMAX+1,0);let o,h,c,l,u,f;const d=y(this.BMAX+1,0);let g,m;const w=new M,_=y(this.BMAX,null),x=y(this.N_MAX,0),E=y(this.BMAX+1,0);let p,b=this.root=null;o=e>256?t[256]:this.BMAX,g=t,m=0,l=e;do{a[g[m]]++,m++}while(--l>0);if(a[0]===e)return this.root=null,this.m=0,void(this.status=0);for(u=1;u<=this.BMAX&&0===a[u];u++);for(f=u,n<u&&(n=u),l=this.BMAX;0!==l&&0===a[l];l--);const L=l;for(n>l&&(n=l),p=1<<u;u<l;u++,p<<=1)if((p-=a[u])<0)return this.status=2,void(this.m=n);if((p-=a[l])<0)return this.status=2,void(this.m=n);a[l]+=p,E[1]=u=0,g=a,m=1;let I=2;for(;--l>0;)E[I++]=u+=g[m++];g=t,m=0,l=0;do{0!==(u=g[m++])&&(x[E[u]++]=l)}while(++l<e);e=E[L],E[0]=l=0,g=x,m=0,c=-1;let A=d[0]=0,O=null,T=0;for(;f<=L;f++){let t=a[f];for(;t-- >0;){for(;f>A+d[1+c];){if(A+=d[1+c],c++,T=(T=L-A)>n?n:T,(h=1<<(u=f-A))>t+1){h-=t+1;let e=f;for(;++u<T&&!((h<<=1)<=a[++e]);)h-=a[e]}A+u>o&&A<o&&(u=o-A),T=1<<u,d[1+c]=u,O=[];for(let t=0;t<T;t++)O[t]=new M;b=b?b.next=new F:this.root=new F,b.next=null,b.list=O,_[c]=O,c>0&&(E[c]=l,w.b=d[c],w.e=16+u,w.t=O,u=(l&(1<<A)-1)>>A-d[c],_[c-1][u].e=w.e,_[c-1][u].b=w.b,_[c-1][u].n=w.n,_[c-1][u].t=w.t)}for(w.b=f-A,m>=e?w.e=99:g[m]<i?(w.e=g[m]<256?16:15,w.n=g[m++]):(w.e=r[g[m]-i],w.n=s[g[m++]-i]),h=1<<f-A,u=l>>A;u<T;u+=h)O[u].e=w.e,O[u].b=w.b,O[u].n=w.n,O[u].t=w.t;for(u=1<<f-1;0!=(l&u);u>>=1)l^=u;for(l^=u;(l&(1<<A)-1)!==E[c];)A-=d[c],c--}}this.m=d[1],this.status=0!==p&&1!==L?1:0}}function A(){if(d.length===g)throw new Error("no more byte!");return 255&d[g++]}function O(){R(7&h)}function T(t){for(;h<t;)o|=A()<<h,h+=8;return o&_[t]}function C(t){const e=T(t);return R(t),e}function R(t){o>>=t,h-=t}function B(t){let e=0,i=0;for(;e<8*t;)i|=A()<<e,e+=8;return i}function D(){const t=m,r=t.length;let n,a,o=0;for(;;){for(a=c.list[T(u)],n=a.e;n>16;){if(99===n)return-1;R(a.b),a=a.t[T(n-16)],n=a.e}if(R(a.b),16===n){s&=e-1,t[r+o++]=i[s++]=a.n;continue}if(15===n)break;let h=a.n+C(n);for(a=l.list[T(f)],n=a.e;n>16;){if(99===n)return-1;R(a.b),a=a.t[T(n-16)],n=a.e}R(a.b);let d=s-a.n-C(n);for(;h>0;)h--,d&=e-1,s&=e-1,t[r+o++]=i[s++]=i[d++]}return o}function v(){const t=m,r=t.length;O();const n=B(2);if(n!==(65535&~B(2)))throw new Error("error in compressed data");for(let a=0;a<n;++a)s&=e-1,t[r+a]=i[s++]=B(1);return n}function W(){return w||function(){let t;const e=[];for(t=0;t<144;t++)e[t]=8;for(;t<256;t++)e[t]=9;for(;t<280;t++)e[t]=7;for(;t<288;t++)e[t]=8;const i=new I(e,288,257,x,E,7);if(0!==i.status)throw new Error("HufBuild error: "+i.status);for(t=0;t<30;t++)e[t]=5;const s=new I(e,30,0,p,b,5);if(s.status>1)throw new Error("HufBuild error: "+s.status);w=i.root,n=i.m,r=s.root,a=s.m}(),c=w,l=r,u=n,f=a,D()}function V(){const t=y(316,0),e=257+C(5),i=1+C(5),s=4+C(4);if(e>286||i>30)throw new Error("bad lengths");let r=0;for(;r<s;r++)t[L[r]]=C(3);for(;r<19;r++)t[L[r]]=0;let n=new I(t,19,19,null,null,7);if(0!==n.status)throw new Error("incomplete code set");c=n.root,u=n.m;const a=e+i;let o=0,h=0;for(;o<a;){const e=c.list[T(u)];R(e.b);let i=e.n;if(i<16)t[o++]=h=i;else{if(16===i?i=3+C(2):17===i?(i=3+C(3),h=0):(i=11+C(7),h=0),o+i>a)throw new Error("invalid bit length repeat");for(;i-- >0;)t[o++]=h}}if(n=new I(t,e,257,x,E,9),0!==n.status&&1!==n.status)throw new Error("incomplete code set");c=n.root,u=n.m;for(let s=0;s<i;s++)t[s]=t[s+e];if(n=new I(t,i,0,p,b,6),l=n.root,f=n.m,0===f&&e>257)throw new Error("incomplete distance tree");if(0!==n.status)throw new Error("incomplete distance tree");return D()}function k(){i||(i=[]),s=0,o=0,h=0}t.inflate=function(t){const e=[];return k(),d=t,g=2,m=e,function(){let t=0,e=0,i=!1;for(;!i;){0!==C(1)&&(i=!0);const s=C(2);switch(s){case 0:console.info("read stored block"),e=v();break;case 1:console.info("read fixed block"),e=W();break;case 2:console.info("read dynamic block"),e=V();break;default:throw new Error("bad block type:"+s)}t+=e}}(),d=null,m=null,e}}(OLE||(OLE={})),function(t){class e{constructor(e,i){this.nx=0,this.ny=0,t.defined(e)&&(this.nx=0|e,this.ny=0|i)}}class i{constructor(e,i){this.x=0,this.y=0,t.defined(e)&&(this.x=e,this.y=i)}clone(){return new i(this.x,this.y)}copyFrom(t){this.x=t.x,this.y=t.y}equal(t){return this.x==t.x&&this.y==t.y}}class s{constructor(){this.u=0,this.v=0}}t.StreamLine=class{constructor(e){this.mLines=[],this.mOption=t.deepAssign({lineSpace:19,interpCount:20,interpStep:.05,minLength:1,maxPoints:2e3,maxStay:100,forwardOnly:!1,showArrow:!0,arrowDist:5,arrowSize:1},e),this.initUsedCache()}clear(){this.mLines=[]}initUsedCache(){const t=this.mOption.lineSpace>>1;this.mUsedCache=[];const i=t*t;for(let s=-t;s<=t;s++)for(let r=-t;r<=t;r++){r*r+s*s<i&&this.mUsedCache.push(new e(r,s))}}generate(t){this.clear(),this.mDataU=t.u,this.mDataV=t.v,this.mWidth=t.width,this.mHeight=t.height,this.mRange=t.range;const e=t.width*t.height;this.mFlags=new Uint32Array(e),this.mFlags2=new Uint8Array(e);let s=0,r=0;const n=new i;for(;-1!=(s=this.getSeed())&&this.mLines.length<2e3;){++r,n.x=.5+(s%this.mWidth|0),n.y=.5+(s/this.mWidth|0),this.mFlags[s]=r;const t=[];this.mOption.forwardOnly||(this.trackStreamLine(r,n,t,-1),t.length>0&&t.reverse()),t.push(n.clone()),this.trackStreamLine(r,n,t,1),t.length<=1||(this.mLines.push(t),this.setLineUsed(t,r))}return this.getLines()}getLines(){const e=t.Extents.width(this.mRange),i=t.Extents.height(this.mRange),r=this.mWidth,a=this.mHeight,[o,h]=this.mRange,{showArrow:c,showTailArrow:l,minLength:u,arrowSize:f,arrowDist:d}=this.mOption;function g(t,s){return[t/r*e+o,s/a*i+h]}function m(t){return g(t.x,t.y)}const w=new s,_=t=>{const e=t.x,i=t.y;this.interpValueXY(e,i,w);const s=Math.atan2(w.v,w.u),r=2.7925268,n=f,a=[];return a.push(g(e+n*Math.cos(s+r),i+n*Math.sin(s+r))),a.push(g(e,i)),a.push(g(e+n*Math.cos(s-r),i+n*Math.sin(s-r))),a},x=this.mLines,E=[],p=x.length;for(let t=0;t<p;++t){const e=x[t],i=e.length;let s=0,r=0;const a=[];let o=e[0];const h=[];for(let t=0;t<i;++t){const i=e[t];h.push(m(i));const c=n(o,i);s+=c,r+=c,s>d&&(a.push(i),s-=d),o=i}if(r<u)continue;const f=a.length,g=[];if(c&&f>0)for(let t=0;t<f;++t)g.push(_(a[t]));let w;l&&(w=_(o)),E.push({id:t,line:h,tail:w,arrows:g})}return E}trackStreamLine(e,i,s,r){let n=i;const a=new Map,{mWidth:o,mHeight:h,mFlags2:c}=this,{maxStay:l,interpStep:u,maxPoints:f}=this.mOption;for(;s.length<f;){const e=this.interpNextPosition(n,u,r);if(e.equal(n))break;if(e.x<=0||e.x>=o-1||e.y<=0||e.y>=h-1)break;const i=(0|e.x)+(0|e.y)*o;if(0!==c[i])break;const f=t.defaultValue(a.get(i),0);if(f>l)break;a.set(i,f+1),s.push(e),n=e}}getSeed(){const t=this.mFlags.length;for(let e=0;e<t;e++)if(0==this.mFlags[e])return e;return-1}setLineUsed(t,e){let i=-1,s=-1;t.forEach(t=>{const r=0|t.x,n=0|t.y;r===i&&n===s||(this.setUsed(r,n,e),i=r,s=n)})}setUsed(t,e,i){const{mFlags:s,mUsedCache:r,mWidth:n,mHeight:a}=this,o=r.length;for(let h=0;h<o;h++){const o=r[h],c=t+o.nx,l=e+o.ny;if(c<0||c>=n||l<0||l>=a)continue;const u=c+l*n;0==s[u]&&(s[u]=i)}this.mFlags2[t+e*n]=1}interpValue(t,e){this.interpValueXY(t.x,t.y,e)}interpValueXY(t,e,i){const{mDataU:s,mDataV:r,mWidth:n,mHeight:o}=this,h=a(t-.5,0,n-2),c=a(e-.5,0,o-2),l=0|h,u=0|c,f=l+1,d=u+1,g=l+u*n,m=f+u*n,w=l+d*n,_=f+d*n,x=h-l,E=c-u,p=1-x,b=1-E;i.u=s[g]*p*b+s[m]*x*b+s[w]*p*E+s[_]*x*E,i.v=r[g]*p*b+r[m]*x*b+r[w]*p*E+r[_]*x*E}interpNextPosition(t,e,s){const n=this.mOption.interpCount,a=e/n*s,o=new i(t.x,t.y);for(let t=0;t<n&&(this.interpValue(o,r),0!=r.u||0!=r.v);t++)o.x=o.x+a*r.u,o.y=o.y+a*r.v;return o}};const r=new s;function n(t,e){const i=t.x-e.x,s=t.y-e.y;return Math.sqrt(i*i+s*s)}function a(t,e,i){return t<e?e:t>i?i:t}}(OLE||(OLE={})),function(t){function e(t){let e=Number.MAX_VALUE,i=-Number.MAX_VALUE;const s=t.length;for(let r=0;r<s;++r){const s=t[r];s!==Number.NaN&&(s<e&&(e=s),s>i&&(i=s))}return[e,i]}t.calcLimit=e,t.unpackRasterData=function(t){return t.startsWith("deflater:")?r(t.substring(9)):s(t)};const i=12;function s(e){const s=t.Base64.toByteArray(e),r=new DataView(s.buffer),n=r.getInt32(0,!0),a=r.getFloat32(4,!0),o=r.getFloat32(8,!0),h=o-a;if(s.byteLength-i!=n)throw new Error("bad raster data.");const c=Math.floor(a-.1*h),l=new Float32Array(n);for(let t=0;t<n;++t){if(0===s[t+i]){l[t]=c;continue}const e=s[t+i]/255*h+a;l[t]=e}return{data:l,min:a,max:o,noData:c}}function r(e){const i=t.Base64.toByteArray(e),s=t.inflate(i),r=new Uint8Array(s),n=new DataView(r.buffer),a=n.getInt32(0,!0),o=n.getInt32(4,!0),h=n.getInt32(8,!0)/o,c=new Int32Array(r.buffer,12);if(c.length!=a)throw new Error("bad raster data.");let l=Number.MAX_VALUE,u=-Number.MAX_VALUE;const f=new Float32Array(a);for(let t=0;t<a;++t){const e=c[t]/o;f[t]=e,e!=h&&(e<l&&(l=e),e>u&&(u=e))}return{data:f,min:l,max:u,noData:h}}function n(t){return void 0!==t&&null!=t}function a(t){return"function"==typeof t||"object"==typeof t&&!Array.isArray(t)}t.decodeRasterData=s,t.inflaterRasterData=r,t.encodeRasterData=function(s){let[r,n]=e(s);const a=(255*r-n)/254,o=n-r,h=new Uint8Array(i+s.length),c=new DataView(h.buffer);return c.setInt32(0,s.length,!0),c.setFloat32(4,a,!0),c.setFloat32(8,n,!0),s.forEach((t,e)=>{h[e+i]=t<r?0:(t-r)/o*254+1}),t.Base64.fromByteArray(h)},t.defined=n,t.defaultValue=function(t,e){return n(t)?t:e},t.defaultValues=function(...t){return t.find(t=>n(t))},t.deepAssign=function t(e,...i){if(null==e)throw new TypeError("Cannot convert undefined or null to object");const s=Object(e);return i.forEach(e=>{if(null!=e)for(let i in e)if(Object.prototype.hasOwnProperty.call(e,i)){const r=s[i],n=e[i];a(r)&&a(n)?t(r,n):s[i]=n}}),s};const o=/([0-9]+)px/;t.getFontSize=function(t){if(o.test(t))return parseFloat(RegExp.$1)},t.guid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var e=16*Math.random()|0;return("x"==t?e:3&e|8).toString(16)}))}}(OLE||(OLE={}));const RasterEngine=OLE,PointEngine=OLE;var OLE;void 0===Array.prototype.last&&(Array.prototype.last=function(){const t=this.length;if(0!=t)return this[t-1]}),function(t){t.RasterWorker=class{constructor(){this.proces=new Map,addEventListener("message",t=>this.onMessage(t),!1),this.proces.set("init",t=>this.init(t)),this.proces.set("resample",t=>this.resample(t)),this.proces.set("iso",t=>this.traceISO(t))}onMessage(t){const e=t.data,i=this.proces.get(e.op);if(!i)return;const s=i(e);s&&self.postMessage({op:e.op,rid:e.rid,data:s.data},s.transfer)}init(e){void 0!==e.raster&&(this.raster=new t.RasterDataset(e.raster)),void 0!==e.filter&&(this.filter=e.filter),void 0!==e.colors&&(this.colors=e.colors)}resample(t){const e=this.raster.subData2(t.extent,t.size,this.filter),i=e.toDataObject();return{data:{raster:i,pixels:e.toPixelData(this.colors)},transfer:[i.data.buffer]}}traceISO(e){return{data:t.IsoTracer.traceByResample(e.mode,e.values,this.raster,e.extent,e.size,this.filter)}}}}(OLE||(OLE={})),importScripts("turf.min.js");const worker1=new OLE.RasterWorker;