var SHLOOKMODEL=function(a){this.map3dTool=a,this.viewer=a.GetView(),this.dviewer=a.GetCegore()};SHLOOKMODEL.prototype.calculateToEastangle=function(a,t){var e=this.calculateToEastanglep(a,t);return[this.calculateToEastangleh(a,t),e]},SHLOOKMODEL.prototype.calculateToEastanglep=function(a,t){var e=this.map3dTool.JWcoordToC3(a),i=this.map3dTool.JWcoordToC3(t),o=this.getEastPointFromPoint(e,0,GmMap3D.Math.toRadians(-90),10),n=GmMap3D.Cartesian3.normalize(GmMap3D.Cartesian3.subtract(o,e,new GmMap3D.Cartesian3),new GmMap3D.Cartesian3),r=GmMap3D.Cartesian3.normalize(GmMap3D.Cartesian3.subtract(i,e,new GmMap3D.Cartesian3),new GmMap3D.Cartesian3),s=GmMap3D.Cartesian3.dot(n,r);return GmMap3D.Math.toDegrees(Math.acos(s))-90},SHLOOKMODEL.prototype.calculateToEastangleh=function(a,t){var e=[],i=[];e.push(a[0]),e.push(a[1]),e.push(a[2]),i.push(t[0]),i.push(t[1]),i.push(a[2]);var o=this.map3dTool.JWcoordToC3(e),n=this.map3dTool.JWcoordToC3(i),r=this.getEastPointFromPoint(o,0,0,10),s=this.getEastPointFromPoint(o,GmMap3D.Math.toRadians(90),0,10),p=this.getEastPointFromPoint(o,GmMap3D.Math.toRadians(-90),0,10),m=GmMap3D.Cartesian3.subtract(n,o,new GmMap3D.Cartesian3),M=0;if(0==m.x&&0==m.y&&0==m.z)M=0;else{var l=GmMap3D.Cartesian3.normalize(GmMap3D.Cartesian3.subtract(n,o,new GmMap3D.Cartesian3),new GmMap3D.Cartesian3),D=GmMap3D.Cartesian3.normalize(GmMap3D.Cartesian3.subtract(s,o,new GmMap3D.Cartesian3),new GmMap3D.Cartesian3),h=GmMap3D.Cartesian3.dot(D,l),c=GmMap3D.Math.toDegrees(Math.acos(h)),G=GmMap3D.Cartesian3.normalize(GmMap3D.Cartesian3.subtract(p,o,new GmMap3D.Cartesian3),new GmMap3D.Cartesian3),d=GmMap3D.Cartesian3.dot(G,l),C=GmMap3D.Math.toDegrees(Math.acos(d)),u=GmMap3D.Cartesian3.normalize(GmMap3D.Cartesian3.subtract(r,o,new GmMap3D.Cartesian3),new GmMap3D.Cartesian3),T=GmMap3D.Cartesian3.dot(u,l),g=GmMap3D.Math.toDegrees(Math.acos(T));M=C>=c?g:-g}return M},SHLOOKMODEL.prototype.getEastPointFromPoint=function(a,t,e,i){var o=new GmMap3D.HeadingPitchRoll(t,e,0),n=GmMap3D.Transforms.headingPitchRollToFixedFrame(a,o,GmMap3D.Ellipsoid.WGS84,GmMap3D.Transforms.eastNorthUpToFixedFrame,new GmMap3D.Matrix4),r=new GmMap3D.Cartesian3(i,0,0);return GmMap3D.Matrix4.multiplyByPoint(n,r,new GmMap3D.Cartesian3)},SHLOOKMODEL.prototype.lookModel=function(a,t,e,i){if(this.viewer.trackedEntity=a,!a||null==a||""==a)return console.log("模型不存在")," The model doesn't exist  ";if(!this.viewer.entities.contains(a))return console.log("模型不存在")," The model doesn't exist  ";for(var o=this.calculateToEastangle(e,i),n=this.viewer.scene.primitives._primitives,r=null,s=0;s<n.length;s++){var p=n[s];if(p.id&&p.id._id===a._id){r=p;break}}var m=null,M=null,l=r._scaledBoundingSphere.radius;if(t){m=t.viewingAngle,M=t.viewDis;if(m){var D=m[1];m=[o[0]+m[0],D]}else m=o;M||(M=50*l)}else m=o,M=50*l;var h=a._position._value,c=this.getEastPointFromPoint(h,GmMap3D.Math.toRadians(m[0]),GmMap3D.Math.toRadians(m[1]),M);this.map3dTool.cartesianTo2MapCoord(c);return cpositon1=GmMap3D.Cartographic.fromCartesian(c),cpositon2=GmMap3D.Cartographic.fromCartesian(h),this.dviewer.camera.lookAtFromTo(cpositon1,cpositon2),this.viewer.trackedEntity=null,[this.map3dTool.cartesianTo2MapCoord(c),this.map3dTool.cartesianTo2MapCoord(h)]};